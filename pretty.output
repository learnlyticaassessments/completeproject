Feature: Wikipedia Language Selector # features/wiki_lang_selector.feature:1
  As a user
  I want to change Wikipedia's language
  So that I can read content in my preferred language
  Feature: Wikipedia Language Selector  # features/wiki_lang_selector.feature:1

  @wikipedia @language-selector
  Scenario: Click language selector button    # features/wiki_lang_selector.feature:10
    Given I am on Wikipedia homepage          # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button # features/steps/wiki_lang_selector_steps.py:22
    Then the language menu should open        # features/steps/wiki_lang_selector_steps.py:154
    And I should see available languages      # features/steps/wiki_lang_selector_steps.py:175

  @wikipedia @language-switch
  Scenario Outline: Switch to different language using selector -- @1.1   # features/wiki_lang_selector.feature:25
    Given I am on Wikipedia homepage                                      # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button                             # features/steps/wiki_lang_selector_steps.py:22
    And I select "English" from the language menu                         # features/steps/wiki_lang_selector_steps.py:72
    Then I should be on "en" Wikipedia                                    # features/steps/wiki_lang_selector_steps.py:186
    And the page should be in "English"                                   # features/steps/wiki_lang_selector_steps.py:198
    And content direction should be "ltr"                                 # features/steps/wiki_lang_selector_steps.py:221

  @wikipedia @language-switch
  Scenario Outline: Switch to different language using selector -- @1.2   # features/wiki_lang_selector.feature:26
    Given I am on Wikipedia homepage                                      # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button                             # features/steps/wiki_lang_selector_steps.py:22
    And I select "Español" from the language menu                         # features/steps/wiki_lang_selector_steps.py:72
    Then I should be on "es" Wikipedia                                    # features/steps/wiki_lang_selector_steps.py:186
    And the page should be in "Español"                                   # features/steps/wiki_lang_selector_steps.py:198
    And content direction should be "ltr"                                 # features/steps/wiki_lang_selector_steps.py:221

  @wikipedia @language-switch
  Scenario Outline: Switch to different language using selector -- @1.3   # features/wiki_lang_selector.feature:27
    Given I am on Wikipedia homepage                                      # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button                             # features/steps/wiki_lang_selector_steps.py:22
      Traceback (most recent call last):
        File "/opt/anaconda3/lib/python3.13/site-packages/behave/model.py", line 1991, in run
          match.run(runner.context)
          ~~~~~~~~~^^^^^^^^^^^^^^^^
        File "/opt/anaconda3/lib/python3.13/site-packages/behave/matchers.py", line 105, in run
          self.func(context, *args, **kwargs)
          ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "features/steps/wiki_lang_selector_steps.py", line 62, in step_click_language_selector
          language_elem.click()
          ~~~~~~~~~~~~~~~~~~~^^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/sync_api/_generated.py", line 15631, in click
          self._sync(
          ~~~~~~~~~~^
              self._impl_obj.click(
              ^^^^^^^^^^^^^^^^^^^^^
          ...<10 lines>...
              )
              ^
          )
          ^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_sync_base.py", line 115, in _sync
          return task.result()
                 ~~~~~~~~~~~^^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_locator.py", line 162, in click
          return await self._frame._click(self._selector, strict=True, **params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 566, in _click
          await self._channel.send("click", self._timeout, locals_to_params(locals()))
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
          return await self._connection.wrap_api_call(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          ...<3 lines>...
          )
          ^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
          raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
      playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.
      Call log:
        - waiting for locator("text=/language/i").first
          - locator resolved to <span>Edit interlanguage links</span>
        - attempting click action
          2 × waiting for element to be visible, enabled and stable
            - element is not visible
          - retrying click action
          - waiting 20ms
          2 × waiting for element to be visible, enabled and stable
            - element is not visible
          - retrying click action
            - waiting 100ms
          58 × waiting for element to be visible, enabled and stable
             - element is not visible
           - retrying click action
             - waiting 500ms

    And I select "العربية" from the language menu                         # None
    Then I should be on "ar" Wikipedia                                    # None
    And the page should be in "العربية"                                   # None
    And content direction should be "rtl"                                 # None
----
CAPTURED STDOUT: before_scenario
✓ Started scenario: Switch to different language using selector -- @1.3  (Locale: en-US)
----
CAPTURED STDOUT: after_scenario
❌ Finished scenario: Switch to different language using selector -- @1.3  - Status.error
----
CAPTURED STDOUT: scenario
✓ Opened Wikipedia homepage
✗ Could not find language selector: Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("text=/language/i").first
    - locator resolved to <span>Edit interlanguage links</span>
  - attempting click action
    2 × waiting for element to be visible, enabled and stable
      - element is not visible
    - retrying click action
    - waiting 20ms
    2 × waiting for element to be visible, enabled and stable
      - element is not visible
    - retrying click action
      - waiting 100ms
    58 × waiting for element to be visible, enabled and stable
       - element is not visible
     - retrying click action
       - waiting 500ms
---- CAPTURED_SCENARIO_OUTPUT_END ----

  @wikipedia @language-switch
  Scenario Outline: Switch to different language using selector -- @1.4   # features/wiki_lang_selector.feature:28
    Given I am on Wikipedia homepage                                      # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button                             # features/steps/wiki_lang_selector_steps.py:22
    And I select "日本語" from the language menu                             # features/steps/wiki_lang_selector_steps.py:72
    Then I should be on "ja" Wikipedia                                    # features/steps/wiki_lang_selector_steps.py:186
    And the page should be in "日本語"                                       # features/steps/wiki_lang_selector_steps.py:198
    And content direction should be "ltr"                                 # features/steps/wiki_lang_selector_steps.py:221

  @wikipedia @language-switch
  Scenario Outline: Switch to different language using selector -- @1.5   # features/wiki_lang_selector.feature:29
    Given I am on Wikipedia homepage                                      # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button                             # features/steps/wiki_lang_selector_steps.py:22
    And I select "Français" from the language menu                        # features/steps/wiki_lang_selector_steps.py:72
    Then I should be on "fr" Wikipedia                                    # features/steps/wiki_lang_selector_steps.py:186
    And the page should be in "Français"                                  # features/steps/wiki_lang_selector_steps.py:198
    And content direction should be "ltr"                                 # features/steps/wiki_lang_selector_steps.py:221

  @wikipedia @language-switch
  Scenario Outline: Switch to different language using selector -- @1.6   # features/wiki_lang_selector.feature:30
    Given I am on Wikipedia homepage                                      # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button                             # features/steps/wiki_lang_selector_steps.py:22
    And I select "Deutsch" from the language menu                         # features/steps/wiki_lang_selector_steps.py:72
    Then I should be on "de" Wikipedia                                    # features/steps/wiki_lang_selector_steps.py:186
    And the page should be in "Deutsch"                                   # features/steps/wiki_lang_selector_steps.py:198
    And content direction should be "ltr"                                 # features/steps/wiki_lang_selector_steps.py:221

  @wikipedia @language-search
  Scenario: Search for specific language            # features/wiki_lang_selector.feature:33
    Given I am on Wikipedia homepage                # features/steps/wiki_lang_selector_steps.py:9
    When I click the language selector button       # features/steps/wiki_lang_selector_steps.py:22
    Then I should see a language search box         # features/steps/wiki_lang_selector_steps.py:240
    When I search for "Arabic" in language selector # features/steps/wiki_lang_selector_steps.py:117
      Traceback (most recent call last):
        File "/opt/anaconda3/lib/python3.13/site-packages/behave/model.py", line 1991, in run
          match.run(runner.context)
          ~~~~~~~~~^^^^^^^^^^^^^^^^
        File "/opt/anaconda3/lib/python3.13/site-packages/behave/matchers.py", line 105, in run
          self.func(context, *args, **kwargs)
          ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "features/steps/wiki_lang_selector_steps.py", line 124, in step_search_language
          search_input.wait_for(state='visible', timeout=5000)
          ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/sync_api/_generated.py", line 18074, in wait_for
          self._sync(self._impl_obj.wait_for(timeout=timeout, state=state))
          ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_sync_base.py", line 115, in _sync
          return task.result()
                 ~~~~~~~~~~~^^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_locator.py", line 710, in wait_for
          await self._frame.wait_for_selector(
              self._selector, strict=True, timeout=timeout, state=state
          )
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 369, in wait_for_selector
          await self._channel.send(
              "waitForSelector", self._timeout, locals_to_params(locals())
          )
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
          return await self._connection.wrap_api_call(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
          ...<3 lines>...
          )
          ^
        File "/opt/anaconda3/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
          raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
      playwright._impl._errors.TimeoutError: Locator.wait_for: Timeout 5000ms exceeded.
      Call log:
        - waiting for locator("input[placeholder*=\"Search\"]").first to be visible

    Then "العربية" should appear in results         # None
    When I click on "العربية"                       # None
    Then I should be on Arabic Wikipedia            # None
    And document direction should be "rtl"          # None
----
CAPTURED STDOUT: before_scenario
✓ Started scenario: Search for specific language (Locale: en-US)
----
CAPTURED STDOUT: after_scenario
❌ Finished scenario: Search for specific language - Status.error
----
CAPTURED STDOUT: scenario
✓ Opened Wikipedia homepage
✓ Clicked language selector (Method 4: Text search)
✓ Language search box is visible
✗ Could not find language search box: Locator.wait_for: Timeout 5000ms exceeded.
Call log:
  - waiting for locator("input[placeholder*=\"Search\"]").first to be visible
---- CAPTURED_SCENARIO_OUTPUT_END ----

